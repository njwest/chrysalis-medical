var ExpressionManager=function(){function duplicatePropertyValue(e,t){if(t=t||1,"number"==typeof e)return e*t;if(e.i)return JSON.parse(JSON.stringify(e));var r,a=Array.apply(null,{length:e.length}),n=e.length;for(r=0;r<n;r+=1)a[r]=e[r]*t;return a}function $bm_neg(e){var t=typeof e;if("number"===t||"boolean"===t)return-e;if("object"===t){var r,a=e.length,n=[];for(r=0;r<a;r+=1)n[r]=-e[r];return n}}function sum(e,t){var r=typeof e,a=typeof t;if("string"===r||"string"===a)return e+t;if(!("number"!==r&&"boolean"!==r||"number"!==a&&"boolean"!==a))return e+t;if("object"===r&&("number"===a||"boolean"===a))return e[0]=e[0]+t,e;if(("number"===r||"boolean"===r)&&"object"===a)return t[0]=e+t[0],t;if("object"===r&&"object"===a){for(var n=0,i=e.length,o=t.length,l=[];n<i||n<o;)"number"==typeof e[n]&&"number"==typeof t[n]?l[n]=e[n]+t[n]:l[n]=void 0==t[n]?e[n]:e[n]||t[n],n+=1;return l}return 0}function sub(e,t){var r=typeof e,a=typeof t;if(!("number"!==r&&"boolean"!==r||"number"!==a&&"boolean"!==a))return e-t;if("object"===r&&("number"===a||"boolean"===a))return e[0]=e[0]-t,e;if(("number"===r||"boolean"===r)&&"object"===a)return t[0]=e-t[0],t;if("object"===r&&"object"===a){for(var n=0,i=e.length,o=t.length,l=[];n<i||n<o;)"number"==typeof e[n]&&"number"==typeof t[n]?l[n]=e[n]-t[n]:l[n]=void 0==t[n]?e[n]:e[n]||t[n],n+=1;return l}return 0}function mul(e,t){var r,a=typeof e,n=typeof t;if(!("number"!==a&&"boolean"!==a||"number"!==n&&"boolean"!==n))return e*t;var i,o;if("object"===a&&("number"===n||"boolean"===n)){for(o=e.length,r=Array.apply(null,{length:o}),i=0;i<o;i+=1)r[i]=e[i]*t;return r}if(("number"===a||"boolean"===a)&&"object"===n){for(o=t.length,r=Array.apply(null,{length:o}),i=0;i<o;i+=1)r[i]=e*t[i];return r}return 0}function div(e,t){var r,a=typeof e,n=typeof t;if(!("number"!==a&&"boolean"!==a||"number"!==n&&"boolean"!==n))return e/t;var i,o;if("object"===a&&("number"===n||"boolean"===n)){for(o=e.length,r=Array.apply(null,{length:o}),i=0;i<o;i+=1)r[i]=e[i]/t;return r}if(("number"===a||"boolean"===a)&&"object"===n){for(o=t.length,r=Array.apply(null,{length:o}),i=0;i<o;i+=1)r[i]=e/t[i];return r}return 0}function clamp(e,t,r){if(t>r){var a=r;r=t,t=a}return Math.min(Math.max(e,t),r)}function radiansToDegrees(e){return e/degToRads}function degreesToRadians(e){return e*degToRads}function length(e,t){t||(t=helperLengthArray);var r,a=Math.min(e.length,t.length),n=0;for(r=0;r<a;r+=1)n+=Math.pow(t[r]-e[r],2);return Math.sqrt(n)}function rgbToHsl(e){var t,r,a=e[0],n=e[1],i=e[2],o=Math.max(a,n,i),l=Math.min(a,n,i),h=(o+l)/2;if(o==l)t=r=0;else{var f=o-l;switch(r=h>.5?f/(2-o-l):f/(o+l),o){case a:t=(n-i)/f+(n<i?6:0);break;case n:t=(i-a)/f+2;break;case i:t=(a-n)/f+4}t/=6}return[t,r,h,e[3]]}function hslToRgb(e){function t(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}var r,a,n,i=e[0],o=e[1],l=e[2];if(0==o)r=a=n=l;else{var h=l<.5?l*(1+o):l+o-l*o,f=2*l-h;r=t(f,h,i+1/3),a=t(f,h,i),n=t(f,h,i-1/3)}return[r,a,n,e[3]]}function linear(e,t,r,a,n){if(void 0===a||void 0===n)return linear(e,0,1,t,r);if(e<=t)return a;if(e>=r)return n;var i=r===t?0:(e-t)/(r-t);if(!a.length)return a+(n-a)*i;var o,l=a.length,h=Array.apply(null,{length:l});for(o=0;o<l;o+=1)h[o]=a[o]+(n[o]-a[o])*i;return h}function seedRandom(e){BMMath.seedrandom(e)}function random(e,t){if(void 0===t&&(void 0===e?(e=0,t=1):(t=e,e=void 0)),t.length){var r,a=t.length;e||(e=Array.apply(null,{length:a}));var n=Array.apply(null,{length:a}),i=BMMath.random();for(r=0;r<a;r+=1)n[r]=e[r]+i*(t[r]-e[r]);return n}void 0===e&&(e=0);var o=BMMath.random();return e+o*(t-e)}function initiateExpression(elem,data,property){function lookAt(e,t){var r=[t[0]-e[0],t[1]-e[1],t[2]-e[2]],a=Math.atan2(r[0],Math.sqrt(r[1]*r[1]+r[2]*r[2]))/degToRads,n=-Math.atan2(r[1],r[2])/degToRads;return[n,a,0]}function easeOut(e,t,r){return-(r-t)*e*(e-2)+t}function nearestKey(e){var t,r,a,n=data.k.length;if(data.k.length&&"number"!=typeof data.k[0]){for(r=-1,e*=elem.comp.globalData.frameRate,t=0;t<n-1;t+=1){if(e===data.k[t].t){r=t+1,a=data.k[t].t;break}if(e>data.k[t].t&&e<data.k[t+1].t){e-data.k[t].t>data.k[t+1].t-e?(r=t+2,a=data.k[t+1].t):(r=t+1,a=data.k[t].t);break}}r===-1&&(r=t+1,a=data.k[t].t)}else r=0,a=0;var i={};return i.index=r,i.time=a/elem.comp.globalData.frameRate,i}function key(e){if(!data.k.length||"number"==typeof data.k[0])return{time:0};e-=1;var t,r={time:data.k[e].t/elem.comp.globalData.frameRate};t=e===data.k.length-1?data.k[e-1].e:data.k[e].s;var a,n=t.length;for(a=0;a<n;a+=1)r[a]=t[a];return r}function framesToTime(e,t){return t||(t=elem.comp.globalData.frameRate),e/t}function timeToFrames(e,t){return e||(e=time),t||(t=elem.comp.globalData.frameRate),e*t}function toWorld(e){if(toworldMatrix.reset(),elem.finalTransform.mProp.applyToMatrix(toworldMatrix),elem.hierarchy&&elem.hierarchy.length){var t,r=elem.hierarchy.length;for(t=0;t<r;t+=1)elem.hierarchy[t].finalTransform.mProp.applyToMatrix(toworldMatrix);return toworldMatrix.applyToPointArray(e[0],e[1],e[2]||0)}return toworldMatrix.applyToPointArray(e[0],e[1],e[2]||0)}function fromWorld(e){fromworldMatrix.reset();var t=[];if(t.push(e),elem.finalTransform.mProp.applyToMatrix(fromworldMatrix),elem.hierarchy&&elem.hierarchy.length){var r,a=elem.hierarchy.length;for(r=0;r<a;r+=1)elem.hierarchy[r].finalTransform.mProp.applyToMatrix(fromworldMatrix);return fromworldMatrix.inversePoints(t)[0]}return fromworldMatrix.inversePoints(t)[0]}function execute(){if(this.frameExpressionId!==elem.globalData.frameId||"textSelector"===this.type){if(this.lock)return this.v=duplicatePropertyValue(this.pv,this.mult),!0;"textSelector"===this.type&&(textIndex=this.textIndex,textTotal=this.textTotal,selectorValue=this.selectorValue),transform||(transform=elem.transform),thisLayer||(thisLayer=elem.layerInterface,thisComp=elem.comp.compInterface),4!==elemType||content||(content=thisLayer("ADBE Root Vectors Group")),effect||(effect=thisLayer(4)),hasParent=!(!elem.hierarchy||!elem.hierarchy.length),hasParent&&!parent&&(parent=elem.hierarchy[elem.hierarchy.length-1].layerInterface),this.lock=!0,this.getPreValue&&this.getPreValue(),value=this.pv,time=this.comp.renderedFrame/this.comp.globalData.frameRate,needsVelocity&&(velocity=velocityAtTime(time)),bindedFn(),this.frameExpressionId=elem.globalData.frameId;var e,t;if(this.mult)if("number"==typeof this.v)this.v*=this.mult;else for(t=this.v.length,value===this.v&&(this.v=2===t?[value[0],value[1]]:[value[0],value[1],value[2]]),e=0;e<t;e+=1)this.v[e]*=this.mult;if("number"==typeof this.v)this.lastValue!==this.v&&(this.lastValue=this.v,this.mdf=!0);else if(this.v.i)this.mdf=!0,this.paths.length=0,this.paths[0]=this.v;else for(t=this.v.length,e=0;e<t;e+=1)this.v[e]!==this.lastValue[e]&&(this.lastValue[e]=this.v[e],this.mdf=!0);this.lock=!1}}var val=data.x,needsVelocity=val.indexOf("velocity")!==-1,elemType=elem.data.ty,transform,content,effect,thisComp=elem.comp,thisProperty=property;elem.comp.frameDuration=1/elem.comp.globalData.frameRate;var inPoint=elem.data.ip/elem.comp.globalData.frameRate,outPoint=elem.data.op/elem.comp.globalData.frameRate,thisLayer,thisComp,fn=new Function,fnStr="var fn = function(){"+val+";this.v = $bm_rt;}";eval(fnStr);var bindedFn=fn.bind(this),numKeys=data.k?data.k.length:0,wiggle=function(e,t){var r,a,n=this.pv.length?this.pv.length:1,i=Array.apply(null,{len:n});for(a=0;a<n;a+=1)i[a]=0;e=5;var o=Math.floor(time*e);for(r=0,a=0;r<o;){for(a=0;a<n;a+=1)i[a]+=-t+2*t*BMMath.random();r+=1}var l=time*e,h=l-Math.floor(l),f=Array.apply({length:n});for(a=0;a<n;a+=1)f[a]=this.pv[a]+i[a]+(-t+2*t*BMMath.random())*h;return f}.bind(this),loopIn=function(e,t,r){if(!this.k)return this.pv;var a=time*elem.comp.globalData.frameRate,n=this.keyframes,i=n[0].t;if(a>=i)return this.pv;var o,l;r?(o=t?Math.abs(elem.comp.globalData.frameRate*t):Math.max(0,this.elem.data.op-i),l=i+o):((!t||t>n.length-1)&&(t=n.length-1),l=n[t].t,o=l-i);var h,f,u;if("pingpong"===e){var m=Math.floor((i-a)/o);if(m%2===0)return this.getValueAtTime((i-a)%o+i,0)}else{if("offset"===e){var s=this.getValueAtTime(i,0),p=this.getValueAtTime(l,0),c=this.getValueAtTime(o-(i-a)%o+i,0),g=Math.floor((i-a)/o)+1;if(this.pv.length){for(u=new Array(s.length),f=u.length,h=0;h<f;h+=1)u[h]=c[h]-(p[h]-s[h])*g;return u}return c-(p-s)*g}if("continue"===e){var d=this.getValueAtTime(i,0),v=this.getValueAtTime(i+.001,0);if(this.pv.length){for(u=new Array(d.length),f=u.length,h=0;h<f;h+=1)u[h]=d[h]+(d[h]-v[h])*(i-a)/5e-4;return u}return d+(d-v)*(i-a)/5e-4}}return this.getValueAtTime(o-(i-a)%o+i,0)}.bind(this),loopInDuration=function(e,t){return loopIn(e,t,!0)}.bind(this),loopOut=function(e,t,r){if(!this.k)return this.pv;var a=time*elem.comp.globalData.frameRate,n=this.keyframes,i=n[n.length-1].t;if(a<=i)return this.pv;var o,l;r?(o=t?Math.abs(i-elem.comp.globalData.frameRate*t):Math.max(0,i-this.elem.data.ip),l=i-o):((!t||t>n.length-1)&&(t=n.length-1),l=n[n.length-1-t].t,o=i-l);var h,f,u;if("pingpong"===e){var m=Math.floor((a-l)/o);if(m%2!==0)return this.getValueAtTime(o-(a-l)%o+l,0)}else{if("offset"===e){var s=this.getValueAtTime(l,0),p=this.getValueAtTime(i,0),c=this.getValueAtTime((a-l)%o+l,0),g=Math.floor((a-l)/o);if(this.pv.length){for(u=new Array(s.length),f=u.length,h=0;h<f;h+=1)u[h]=(p[h]-s[h])*g+c[h];return u}return(p-s)*g+c}if("continue"===e){var d=this.getValueAtTime(i,0),v=this.getValueAtTime(i-.001,0);if(this.pv.length){for(u=new Array(d.length),f=u.length,h=0;h<f;h+=1)u[h]=d[h]+(d[h]-v[h])*(a-i)/5e-4;return u}return d+(d-v)*(a-i)/5e-4}}return this.getValueAtTime((a-l)%o+l,0)}.bind(this),loop_out=loopOut,loopOutDuration=function(e,t){return loopOut(e,t,!0)}.bind(this),valueAtTime=function(e){return this.getValueAtTime(e*elem.comp.globalData.frameRate,0)}.bind(this),velocityAtTime=function(e){return this.getVelocityAtTime(e)}.bind(this),comp=elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface),toworldMatrix=new Matrix,fromworldMatrix=new Matrix,time,velocity,value,textIndex,textTotal,selectorValue,index=elem.data.ind+1,hasParent=!(!elem.hierarchy||!elem.hierarchy.length),parent;return execute}var ob={},Math=BMMath,radians_to_degrees=radiansToDegrees,degrees_to_radians=radiansToDegrees,helperLengthArray=[0,0,0,0,0,0];return ob.initiateExpression=initiateExpression,ob}();
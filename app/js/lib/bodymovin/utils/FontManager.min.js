var FontManager=function(){function t(t,e){var s=document.createElement("span");s.style.fontFamily=e;var n=document.createElement("span");n.innerHTML="giItT1WQy@!-/#",s.style.position="absolute",s.style.left="-10000px",s.style.top="-10000px",s.style.fontSize="300px",s.style.fontVariant="normal",s.style.fontStyle="normal",s.style.fontWeight="normal",s.style.letterSpacing="0",s.appendChild(n),document.body.appendChild(s);var i=n.offsetWidth;return n.style.fontFamily=t+", "+e,{node:n,w:i,parent:s}}function e(){var t,s,n,i=this.fonts.length,a=i;for(t=0;t<i;t+=1)if(this.fonts[t].loaded)a-=1;else if("t"===this.fonts[t].fOrigin){if(window.Typekit&&window.Typekit.load&&0===this.typekitLoaded){this.typekitLoaded=1;try{window.Typekit.load({async:!0,active:function(){this.typekitLoaded=2}.bind(this)})}catch(t){}}2===this.typekitLoaded&&(this.fonts[t].loaded=!0)}else"n"===this.fonts[t].fOrigin?this.fonts[t].loaded=!0:(s=this.fonts[t].monoCase.node,n=this.fonts[t].monoCase.w,s.offsetWidth!==n?(a-=1,this.fonts[t].loaded=!0):(s=this.fonts[t].sansCase.node,n=this.fonts[t].sansCase.w,s.offsetWidth!==n&&(a-=1,this.fonts[t].loaded=!0)),this.fonts[t].loaded&&(this.fonts[t].sansCase.parent.parentNode.removeChild(this.fonts[t].sansCase.parent),this.fonts[t].monoCase.parent.parentNode.removeChild(this.fonts[t].monoCase.parent)));0!==a&&Date.now()-this.initTime<h?setTimeout(e.bind(this),20):setTimeout(function(){this.loaded=!0}.bind(this),0)}function s(t,e){var s=document.createElementNS(svgNS,"text");s.style.fontSize="100px",s.style.fontFamily=e.fFamily,s.textContent="1",e.fClass?(s.style.fontFamily="inherit",s.className=e.fClass):s.style.fontFamily=e.fFamily,t.appendChild(s);var n=document.createElement("canvas").getContext("2d");return n.font="100px "+e.fFamily,n}function n(n,i){if(!n)return void(this.loaded=!0);if(this.chars)return this.loaded=!0,void(this.fonts=n.list);var a,o=n.list,r=o.length;for(a=0;a<r;a+=1){if(o[a].loaded=!1,o[a].monoCase=t(o[a].fFamily,"monospace"),o[a].sansCase=t(o[a].fFamily,"sans-serif"),o[a].fPath){if("p"===o[a].fOrigin){var h=document.createElement("style");h.type="text/css",h.innerHTML="@font-face {font-family: "+o[a].fFamily+"; font-style: normal; src: url('"+o[a].fPath+"');}",i.appendChild(h)}else if("g"===o[a].fOrigin){var f=document.createElement("link");f.type="text/css",f.rel="stylesheet",f.href=o[a].fPath,i.appendChild(f)}else if("t"===o[a].fOrigin){var l=document.createElement("script");l.setAttribute("src",o[a].fPath),i.appendChild(l)}}else o[a].loaded=!0;o[a].helper=s(i,o[a]),this.fonts.push(o[a])}e.bind(this)()}function i(t){if(t){this.chars||(this.chars=[]);var e,s,n,i=t.length,a=this.chars.length;for(e=0;e<i;e+=1){for(s=0,n=!1;s<a;)this.chars[s].style===t[e].style&&this.chars[s].fFamily===t[e].fFamily&&this.chars[s].ch===t[e].ch&&(n=!0),s+=1;n||(this.chars.push(t[e]),a+=1)}}}function a(t,e,s){for(var n=0,i=this.chars.length;n<i;){if(this.chars[n].ch===t&&this.chars[n].style===e&&this.chars[n].fFamily===s)return this.chars[n];n+=1}}function o(t,e,s){var n=this.getFontByName(e),i=n.helper;return i.measureText(t).width*s/100}function r(t){for(var e=0,s=this.fonts.length;e<s;){if(this.fonts[e].fName===t)return this.fonts[e];e+=1}return"sans-serif"}var h=5e3,f=function(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.loaded=!1,this.initTime=Date.now()};return f.prototype.addChars=i,f.prototype.addFonts=n,f.prototype.getCharData=a,f.prototype.getFontByName=r,f.prototype.measureText=o,f}();
function CVTextElement(t,e,a){this.textSpans=[],this.yOffset=0,this.fillColorAnim=!1,this.strokeColorAnim=!1,this.strokeWidthAnim=!1,this.stroke=!1,this.fill=!1,this.justifyOffset=0,this.currentRender=null,this.renderType="canvas",this.values={fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)",sWidth:0,fValue:""},this._parent.constructor.call(this,t,e,a)}createElement(CVBaseElement,CVTextElement),CVTextElement.prototype.init=ITextElement.prototype.init,CVTextElement.prototype.getMeasures=ITextElement.prototype.getMeasures,CVTextElement.prototype.getMult=ITextElement.prototype.getMult,CVTextElement.prototype.prepareFrame=ITextElement.prototype.prepareFrame,CVTextElement.prototype.tHelper=document.createElement("canvas").getContext("2d"),CVTextElement.prototype.createElements=function(){this._parent.createElements.call(this)},CVTextElement.prototype.buildNewText=function(){var t=this.currentTextDocumentData;this.renderedLetters=Array.apply(null,{length:this.currentTextDocumentData.l?this.currentTextDocumentData.l.length:0});var e=!1;t.fc?(e=!0,this.values.fill="rgb("+Math.round(255*t.fc[0])+","+Math.round(255*t.fc[1])+","+Math.round(255*t.fc[2])+")"):this.values.fill="rgba(0,0,0,0)",this.fill=e;var a=!1;t.sc&&(a=!0,this.values.stroke="rgb("+Math.round(255*t.sc[0])+","+Math.round(255*t.sc[1])+","+Math.round(255*t.sc[2])+")",this.values.sWidth=t.sw);var s,l,r=this.globalData.fontManager.getFontByName(t.f),i=t.l,n=this.mHelper;this.stroke=a,this.values.fValue=t.s+"px "+this.globalData.fontManager.getFontByName(t.f).fFamily,l=t.t.length,this.tHelper.font=this.values.fValue;var o,h,p,f,c,u,v,g,m,y,x=this.data.singleShape;if(x)var T=0,d=0,b=t.lineWidths,D=t.boxWidth,C=!0;var k=0;for(s=0;s<l;s+=1){o=this.globalData.fontManager.getCharData(t.t.charAt(s),r.fStyle,this.globalData.fontManager.getFontByName(t.f).fFamily);var h;if(h=o?o.data:null,n.reset(),x&&i[s].n&&(T=0,d+=t.yOffset,d+=C?1:0,C=!1),h&&h.shapes){if(c=h.shapes[0].it,v=c.length,n.scale(t.s/100,t.s/100),x){switch(t.ps&&n.translate(t.ps[0],t.ps[1]+t.ascent,0),t.j){case 1:n.translate(t.justifyOffset+(D-b[i[s].line]),0,0);break;case 2:n.translate(t.justifyOffset+(D-b[i[s].line])/2,0,0)}n.translate(T,d,0)}for(m=new Array(v),u=0;u<v;u+=1){for(f=c[u].ks.k.i.length,g=c[u].ks.k,y=[],p=1;p<f;p+=1)1==p&&y.push(n.applyToX(g.v[0][0],g.v[0][1],0),n.applyToY(g.v[0][0],g.v[0][1],0)),y.push(n.applyToX(g.o[p-1][0],g.o[p-1][1],0),n.applyToY(g.o[p-1][0],g.o[p-1][1],0),n.applyToX(g.i[p][0],g.i[p][1],0),n.applyToY(g.i[p][0],g.i[p][1],0),n.applyToX(g.v[p][0],g.v[p][1],0),n.applyToY(g.v[p][0],g.v[p][1],0));y.push(n.applyToX(g.o[p-1][0],g.o[p-1][1],0),n.applyToY(g.o[p-1][0],g.o[p-1][1],0),n.applyToX(g.i[0][0],g.i[0][1],0),n.applyToY(g.i[0][0],g.i[0][1],0),n.applyToX(g.v[0][0],g.v[0][1],0),n.applyToY(g.v[0][0],g.v[0][1],0)),m[u]=y}}else m=[];x&&(T+=i[s].l),this.textSpans[k]?this.textSpans[k].elem=m:this.textSpans[k]={elem:m},k+=1}},CVTextElement.prototype.renderFrame=function(t){if(this._parent.renderFrame.call(this,t)!==!1){var e=this.canvasContext,a=this.finalTransform.mat.props;this.globalData.renderer.save(),this.globalData.renderer.ctxTransform(a),this.globalData.renderer.ctxOpacity(this.finalTransform.opacity),e.font=this.values.fValue,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=4,this.data.singleShape||this.getMeasures();var s,l,r,i,n,o,h=this.renderedLetters,p=this.currentTextDocumentData.l;l=p.length;var f,c,u,v=null,g=null,m=null;for(s=0;s<l;s+=1)if(!p[s].n){if(f=h[s],f&&(this.globalData.renderer.save(),this.globalData.renderer.ctxTransform(f.props),this.globalData.renderer.ctxOpacity(f.o)),this.fill){for(f&&f.fc?v!==f.fc&&(v=f.fc,e.fillStyle=f.fc):v!==this.values.fill&&(v=this.values.fill,e.fillStyle=this.values.fill),c=this.textSpans[s].elem,i=c.length,this.globalData.canvasContext.beginPath(),r=0;r<i;r+=1)for(u=c[r],o=u.length,this.globalData.canvasContext.moveTo(u[0],u[1]),n=2;n<o;n+=6)this.globalData.canvasContext.bezierCurveTo(u[n],u[n+1],u[n+2],u[n+3],u[n+4],u[n+5]);this.globalData.canvasContext.closePath(),this.globalData.canvasContext.fill()}if(this.stroke){for(f&&f.sw?m!==f.sw&&(m=f.sw,e.lineWidth=f.sw):m!==this.values.sWidth&&(m=this.values.sWidth,e.lineWidth=this.values.sWidth),f&&f.sc?g!==f.sc&&(g=f.sc,e.strokeStyle=f.sc):g!==this.values.stroke&&(g=this.values.stroke,e.strokeStyle=this.values.stroke),c=this.textSpans[s].elem,i=c.length,this.globalData.canvasContext.beginPath(),r=0;r<i;r+=1)for(u=c[r],o=u.length,this.globalData.canvasContext.moveTo(u[0],u[1]),n=2;n<o;n+=6)this.globalData.canvasContext.bezierCurveTo(u[n],u[n+1],u[n+2],u[n+3],u[n+4],u[n+5]);this.globalData.canvasContext.closePath(),this.globalData.canvasContext.stroke()}f&&this.globalData.renderer.restore()}this.globalData.renderer.restore(this.data.hasMask),this.firstFrame&&(this.firstFrame=!1)}};